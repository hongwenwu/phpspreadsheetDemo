<?php
require '../vendor/autoload.php';

use App\Office\Excel;

// Add some data
$database = [
    'title'  => 'phpspreadsheetDemo',
    'fields' => ['Tree', 'Height', 'Age', 'Yield', 'Profit', 'Tree', 'Height', 'Age', 'Yield', 'Profit', 'Tree', 'Height', 'Age', 'Yield', 'Profit', 'Tree', 'Height', 'Age', 'Yield', 'Profit', 'Tree', 'Height', 'Age', 'Yield', 'Profit', 'Tree', 'Height', 'Age', 'Yield', 'Profit', 'Tree', 'Height', 'Age', 'Yield', 'Yield123'],
    'data'   => [
        ['Apple', 18, 20, 14, 105.00, 18, 20, 14, 105.00, 18, 20, 14, 105.00, 18, 20, 14, 105.00, 18, 20, 14, 105.00, 18, 20, 14, 105.00, 18, 20, 14, 105.00, 18, 20, 14, 105.00, 14, 105.00],
        ['Pear', 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12],
        ['Pear', 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12],
        ['Pear', 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12],
        ['Pear', 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12],
        ['Pear', 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12, 10, 96.00, 12, 12],
        ['count', '=SUM(B3:B8)']
    ]
];

$excel = new Excel([
    'startCell' => 'A2',
    'column'    => [
        'A' => '00FF0000', 'B' => '00FF0000', 'D' => 'FF0FF000'
    ],
    'merges'    => [
        'cell'     => ['A2:C2', 'D2:E2', 'F2:G2', 'H2:I2'],
        'cellText' => ['A2' => '优惠券(昨日)', 'D2' => '优惠券(今日)', 'F2' => '优惠券增长数据(xxx)', 'H2' => '名片(今日)'],
    ],
]);
$excel->export($database, 'sub.xlsx', dirname(__FILE__));

var_dump($excel->import('sub.xlsx'));
